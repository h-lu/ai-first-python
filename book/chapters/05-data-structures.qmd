# æ•°æ®ç»“æ„ç›´è§‰ {#sec-data-structures}

::: {.callout-note}
## æœ¬ç« æ¦‚è¦
- **è¯¾æ—¶**ï¼š2è¯¾æ—¶ï¼ˆç¬¬5å‘¨ï¼‰
- **ç›®æ ‡**ï¼šå»ºç«‹å¯¹å¸¸ç”¨æ•°æ®ç»“æ„çš„ç›´è§‰ï¼Œå­¦ä¼šå¤„ç† JSON æ•°æ®
:::

## å­¦ä¹ ç›®æ ‡

å®Œæˆæœ¬ç« åï¼Œä½ å°†èƒ½å¤Ÿï¼š

1. çŸ¥é“ä»€ä¹ˆæ—¶å€™ç”¨åˆ—è¡¨ã€å­—å…¸ã€é›†åˆ
2. è®© AI å¸®ä½ é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„
3. å¤„ç† JSON æ ¼å¼çš„æ•°æ®

---

## æ•°æ®ç»“æ„é€‰æ‹©ï¼šç›´è§‰æŒ‡å—

### å››ç§å¸¸ç”¨æ•°æ®ç»“æ„

```{mermaid}
mindmap
  root((æ•°æ®ç»“æ„))
    åˆ—è¡¨ list
      æœ‰åº
      å¯é‡å¤
      ç”¨ç´¢å¼•è®¿é—®
    å­—å…¸ dict
      é”®å€¼å¯¹
      å¿«é€ŸæŸ¥æ‰¾
      ç”¨é”®è®¿é—®
    é›†åˆ set
      æ— åº
      ä¸é‡å¤
      è‡ªåŠ¨å»é‡
    å…ƒç»„ tuple
      æœ‰åº
      ä¸å¯å˜
      å®‰å…¨å›ºå®š
```

| æ•°æ®ç»“æ„ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ | ç¤ºä¾‹ |
|---------|------|---------|------|
| **åˆ—è¡¨ list** | æœ‰åºã€å¯é‡å¤ | ä¸€ç»„åŒç±»æ•°æ® | æˆç»©ï¼š`[85, 90, 75]` |
| **å­—å…¸ dict** | é”®å€¼å¯¹ | æœ‰åå­—çš„æ•°æ® | å­¦ç”Ÿï¼š`{"name": "å¼ ä¸‰", "age": 20}` |
| **é›†åˆ set** | æ— åºã€ä¸é‡å¤ | å»é‡ã€æˆå‘˜åˆ¤æ–­ | æ ‡ç­¾ï¼š`{"Python", "AI"}` |
| **å…ƒç»„ tuple** | æœ‰åºã€ä¸å¯å˜ | å›ºå®šçš„ç»„åˆæ•°æ® | åæ ‡ï¼š`(x, y)` |

### é€‰æ‹©å†³ç­–æµç¨‹

```{mermaid}
flowchart TD
    A["éœ€è¦å­˜å‚¨æ•°æ®"] --> B{"éœ€è¦ç”¨åå­—æŸ¥æ‰¾?"}
    B -->|æ˜¯| C["ğŸ“– å­—å…¸ dict"]
    B -->|å¦| D{"éœ€è¦å»é‡?"}
    D -->|æ˜¯| E["ğŸ¯ é›†åˆ set"]
    D -->|å¦| F{"æ•°æ®å›ºå®šä¸å˜?"}
    F -->|æ˜¯| G["ğŸ”’ å…ƒç»„ tuple"]
    F -->|å¦| H["ğŸ“ åˆ—è¡¨ list"]
    
    style C fill:#e3f2fd
    style E fill:#fff3e0
    style G fill:#f3e5f5
    style H fill:#e8f5e9
```

---

## åˆ—è¡¨ï¼ˆListï¼‰ï¼šæœ‰åºçš„æ•°æ®é›†åˆ

### åŸºæœ¬æ“ä½œ

```{python}
#| eval: true
# åˆ›å»ºåˆ—è¡¨
grades = [85, 92, 78, 60, 45]
names = ["å¼ ä¸‰", "æå››", "ç‹äº”"]

# è®¿é—®å…ƒç´ 
print(grades[0])    # ç¬¬ä¸€ä¸ªï¼š85
print(grades[-1])   # æœ€åä¸€ä¸ªï¼š45
print(grades[1:3])  # åˆ‡ç‰‡ï¼š[92, 78]

# ä¿®æ”¹å…ƒç´ 
grades[0] = 90
print(grades)

# æ·»åŠ å…ƒç´ 
grades.append(88)   # æœ«å°¾æ·»åŠ 
print(grades)

# åˆ—è¡¨é•¿åº¦
print(len(grades))
```

### åˆ—è¡¨å¸¸ç”¨æ–¹æ³•

```{python}
#| eval: true
numbers = [3, 1, 4, 1, 5, 9, 2, 6]

# æ’åº
sorted_nums = sorted(numbers)        # è¿”å›æ–°åˆ—è¡¨
print(f"æ’åºå: {sorted_nums}")

# åè½¬
reversed_nums = list(reversed(numbers))
print(f"åè½¬å: {reversed_nums}")

# æŸ¥æ‰¾
print(f"æœ€å¤§å€¼: {max(numbers)}")
print(f"æœ€å°å€¼: {min(numbers)}")
print(f"æ€»å’Œ: {sum(numbers)}")
print(f"4 çš„ä½ç½®: {numbers.index(4)}")
print(f"1 å‡ºç°æ¬¡æ•°: {numbers.count(1)}")
```

### åˆ—è¡¨æ¨å¯¼å¼

åˆ—è¡¨æ¨å¯¼å¼æ˜¯ Python åˆ›å»ºåˆ—è¡¨çš„ç®€æ´æ–¹å¼ï¼š

```{python}
#| eval: true
# ä¼ ç»Ÿæ–¹å¼
squares = []
for i in range(1, 6):
    squares.append(i ** 2)
print(squares)

# åˆ—è¡¨æ¨å¯¼å¼ï¼ˆæ›´ç®€æ´ï¼‰
squares = [i ** 2 for i in range(1, 6)]
print(squares)

# å¸¦æ¡ä»¶çš„æ¨å¯¼å¼
even_squares = [i ** 2 for i in range(1, 11) if i % 2 == 0]
print(f"å¶æ•°çš„å¹³æ–¹: {even_squares}")
```

---

## å­—å…¸ï¼ˆDictï¼‰ï¼šé”®å€¼å¯¹å­˜å‚¨

### åŸºæœ¬æ“ä½œ

```{python}
#| eval: true
# åˆ›å»ºå­—å…¸
student = {
    "name": "å¼ ä¸‰",
    "age": 20,
    "scores": [85, 92, 78]
}

# è®¿é—®å€¼
print(student["name"])
print(student.get("email", "æœªè®¾ç½®"))  # å®‰å…¨è®¿é—®ï¼Œä¸å­˜åœ¨è¿”å›é»˜è®¤å€¼

# ä¿®æ”¹å€¼
student["age"] = 21

# æ·»åŠ é”®å€¼å¯¹
student["email"] = "zhangsan@example.com"

# éå†å­—å…¸
for key, value in student.items():
    print(f"{key}: {value}")
```

### å­—å…¸ä½¿ç”¨åœºæ™¯

```{python}
#| eval: true
# åœºæ™¯1ï¼šå­˜å‚¨å­¦ç”Ÿä¿¡æ¯
students = {
    "001": {"name": "å¼ ä¸‰", "score": 85},
    "002": {"name": "æå››", "score": 92},
    "003": {"name": "ç‹äº”", "score": 78}
}

# æŒ‰å­¦å·æŸ¥æ‰¾
print(students["001"]["name"])  # å¼ ä¸‰

# åœºæ™¯2ï¼šç»Ÿè®¡è¯é¢‘
text = "apple banana apple orange banana apple"
word_count = {}
for word in text.split():
    word_count[word] = word_count.get(word, 0) + 1
print(word_count)
```

### å­—å…¸æ¨å¯¼å¼

```{python}
#| eval: true
# ä»åˆ—è¡¨åˆ›å»ºå­—å…¸
names = ["å¼ ä¸‰", "æå››", "ç‹äº”"]
scores = [85, 92, 78]

# å­—å…¸æ¨å¯¼å¼
score_dict = {name: score for name, score in zip(names, scores)}
print(score_dict)

# ç­›é€‰å­—å…¸
passed = {name: score for name, score in score_dict.items() if score >= 60}
print(f"åŠæ ¼çš„å­¦ç”Ÿ: {passed}")
```

---

## é›†åˆï¼ˆSetï¼‰ï¼šå»é‡å’Œæˆå‘˜æ£€æµ‹

### åŸºæœ¬æ“ä½œ

```{python}
#| eval: true
# åˆ›å»ºé›†åˆ
tags = {"Python", "AI", "æ•°æ®åˆ†æ", "Python"}  # è‡ªåŠ¨å»é‡
print(tags)

# æ·»åŠ å…ƒç´ 
tags.add("æœºå™¨å­¦ä¹ ")
print(tags)

# æˆå‘˜æ£€æµ‹
print("Python" in tags)  # True
print("Java" in tags)    # False
```

### é›†åˆè¿ç®—

```{python}
#| eval: true
# é›†åˆè¿ç®—
a = {1, 2, 3, 4}
b = {3, 4, 5, 6}

print(f"äº¤é›†: {a & b}")        # {3, 4}
print(f"å¹¶é›†: {a | b}")        # {1, 2, 3, 4, 5, 6}
print(f"å·®é›†: {a - b}")        # {1, 2}
print(f"å¯¹ç§°å·®é›†: {a ^ b}")    # {1, 2, 5, 6}
```

### å®ç”¨æ¡ˆä¾‹ï¼šå»é‡

```{python}
#| eval: true
# åˆ—è¡¨å»é‡
names = ["å¼ ä¸‰", "æå››", "å¼ ä¸‰", "ç‹äº”", "æå››"]
unique_names = list(set(names))
print(f"å»é‡å: {unique_names}")

# æ‰¾å‡ºé‡å¤å…ƒç´ 
seen = set()
duplicates = set()
for name in names:
    if name in seen:
        duplicates.add(name)
    seen.add(name)
print(f"é‡å¤çš„: {duplicates}")
```

---

## JSON æ•°æ®å¤„ç†

### ä»€ä¹ˆæ˜¯ JSONï¼Ÿ

JSONï¼ˆJavaScript Object Notationï¼‰æ˜¯ä¸€ç§é€šç”¨çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼ŒPython ä¸­ç”¨å­—å…¸å’Œåˆ—è¡¨æ¥è¡¨ç¤ºã€‚

```{mermaid}
flowchart LR
    A["JSON æ–‡ä»¶"] -->|json.load| B["Python å­—å…¸/åˆ—è¡¨"]
    B -->|json.dump| C["JSON æ–‡ä»¶"]
    
    D["JSON å­—ç¬¦ä¸²"] -->|json.loads| E["Python å¯¹è±¡"]
    E -->|json.dumps| F["JSON å­—ç¬¦ä¸²"]
```

### è¯»å†™ JSON æ–‡ä»¶

```{python}
#| eval: false
import json

# å†™å…¥ JSON æ–‡ä»¶
data = {
    "students": [
        {"id": "001", "name": "å¼ ä¸‰", "scores": [85, 90, 78]},
        {"id": "002", "name": "æå››", "scores": [92, 88, 95]}
    ],
    "class_name": "è®¡ç®—æœº1ç­"
}

with open("data.json", "w", encoding="utf-8") as f:
    json.dump(data, f, ensure_ascii=False, indent=2)

# è¯»å– JSON æ–‡ä»¶
with open("data.json", "r", encoding="utf-8") as f:
    loaded_data = json.load(f)

# ä½¿ç”¨æ•°æ®
for student in loaded_data["students"]:
    avg = sum(student["scores"]) / len(student["scores"])
    print(f"{student['name']}: å¹³å‡åˆ† {avg:.1f}")
```

### è®© AI å¸®ä½ å¤„ç† JSON

**Prompt ç¤ºä¾‹**ï¼š
```
æˆ‘æœ‰ä¸€ä¸ª JSON æ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š
{
  "students": [
    {"name": "å¼ ä¸‰", "scores": {"math": 85, "english": 90}},
    {"name": "æå››", "scores": {"math": 92, "english": 88}}
  ]
}

å¸®æˆ‘å†™ä¸€ä¸ªå‡½æ•°ï¼Œè®¡ç®—æ¯ä¸ªå­¦ç”Ÿçš„å¹³å‡åˆ†ï¼Œè¿”å›æ–°çš„ JSON ç»“æ„ï¼Œ
åŒ…å« name å’Œ average å­—æ®µã€‚
```

---

## å®æˆ˜ï¼šè®© AI å¸®ä½ é€‰æ‹©æ•°æ®ç»“æ„

### åœºæ™¯ 1ï¼šå­˜å‚¨å­¦ç”Ÿé€šè®¯å½•

**æè¿°ç»™ AI**ï¼š
```
æˆ‘éœ€è¦å­˜å‚¨ä¸€ä¸ªç­çº§çš„å­¦ç”Ÿé€šè®¯å½•ï¼š
- æ¯ä¸ªå­¦ç”Ÿæœ‰ï¼šå§“åã€æ‰‹æœºå·ã€é‚®ç®±ã€å®¿èˆå·
- éœ€è¦èƒ½æŒ‰æ‰‹æœºå·å¿«é€ŸæŸ¥æ‰¾å­¦ç”Ÿ
- éœ€è¦èƒ½åˆ—å‡ºæ‰€æœ‰å­¦ç”Ÿ

è¯·å¸®æˆ‘è®¾è®¡åˆé€‚çš„æ•°æ®ç»“æ„ã€‚
```

**AI æ¨è**ï¼š

```{python}
#| eval: true
# ç”¨å­—å…¸ï¼Œæ‰‹æœºå·ä½œä¸ºé”®
contacts = {
    "13800138001": {
        "name": "å¼ ä¸‰",
        "email": "zhang@example.com",
        "dorm": "A301"
    },
    "13900139002": {
        "name": "æå››",
        "email": "li@example.com",
        "dorm": "B205"
    }
}

# æŒ‰æ‰‹æœºå·æŸ¥æ‰¾
phone = "13800138001"
if phone in contacts:
    print(f"æ‰¾åˆ°ï¼š{contacts[phone]['name']}")

# åˆ—å‡ºæ‰€æœ‰å­¦ç”Ÿ
for phone, info in contacts.items():
    print(f"{info['name']}: {phone}")
```

### åœºæ™¯ 2ï¼šç»Ÿè®¡é€‰è¯¾æƒ…å†µ

**æè¿°ç»™ AI**ï¼š
```
æˆ‘éœ€è¦ç»Ÿè®¡å­¦ç”Ÿçš„é€‰è¯¾æƒ…å†µï¼š
- éœ€è¦çŸ¥é“æ¯é—¨è¯¾æœ‰å“ªäº›å­¦ç”Ÿé€‰
- éœ€è¦çŸ¥é“æ¯ä¸ªå­¦ç”Ÿé€‰äº†å“ªäº›è¯¾
- éœ€è¦ç»Ÿè®¡é€‰è¯¾äººæ•°æœ€å¤šçš„è¯¾ç¨‹

è¯·å¸®æˆ‘è®¾è®¡æ•°æ®ç»“æ„å’Œç›¸å…³å‡½æ•°ã€‚
```

---

## è¯¾åä½œä¸š

### ç»§ç»­ä½œä¸š 2ï¼šæˆç»©ç»Ÿè®¡åˆ†æå™¨

**æœ¬å‘¨ä»»åŠ¡**ï¼šå¤„ç†è¾¹ç•Œæƒ…å†µ

1. `test_grade_missing_value`: ç¼ºå¤±æˆç»©å¤„ç†
2. `test_grade_invalid_score`: éæ³•åˆ†æ•°æ£€æµ‹
3. `test_grade_duplicate_id`: é‡å¤å­¦å·æ£€æµ‹

**æäº¤æˆªæ­¢**ï¼šæœ¬å‘¨æ—¥

---

## æœ¬ç« å°ç»“

- **åˆ—è¡¨**ï¼šæœ‰åºå¯é‡å¤ï¼Œé€‚åˆä¸€ç»„åŒç±»æ•°æ®
- **å­—å…¸**ï¼šé”®å€¼å¯¹ï¼Œé€‚åˆéœ€è¦æŒ‰åç§°æŸ¥æ‰¾çš„æ•°æ®
- **é›†åˆ**ï¼šè‡ªåŠ¨å»é‡ï¼Œé€‚åˆæˆå‘˜æ£€æµ‹
- **JSON**ï¼šé€šç”¨æ•°æ®äº¤æ¢æ ¼å¼ï¼Œç”¨ `json` æ¨¡å—å¤„ç†
- **ç›´è§‰æ³•åˆ™**ï¼šéœ€è¦æŸ¥æ‰¾ç”¨å­—å…¸ï¼Œéœ€è¦å»é‡ç”¨é›†åˆï¼Œå…¶ä»–ç”¨åˆ—è¡¨
- ä¸ç¡®å®šæ—¶ï¼Œ**æè¿°éœ€æ±‚ç»™ AI**ï¼Œè®©å®ƒå¸®ä½ é€‰æ‹©

ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬å°†å­¦ä¹ **æ–‡ä»¶æ“ä½œ**â€”â€”å¦‚ä½•è¯»å†™å¤–éƒ¨æ•°æ®ã€‚
