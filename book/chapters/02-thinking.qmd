# 计算思维与问题分解 {#sec-thinking}

::: {.callout-note}
## 本章概要
- **课时**：2课时（第2周）
- **目标**：掌握计算思维，学会 Prompt Engineering 基础
:::

## 学习目标

完成本章后，你将能够：

1. 理解计算思维的四大核心能力
2. 将复杂问题分解为可执行的步骤
3. 编写有效的 AI Prompt

---

## 什么是计算思维？

计算思维（Computational Thinking）是一种解决问题的思维方式，它不依赖于具体的编程语言，而是一种通用的问题解决框架。

::: {.callout-tip}
## AI 时代还需要计算思维吗？
**答案是：更需要！**

AI 负责"写代码"，人负责"想清楚问题"。如果你不能清晰地描述问题，AI 也无法帮你解决。
:::

### 四大核心能力

```{mermaid}
mindmap
  root((计算思维))
    分解
      大问题拆成小问题
      模块化处理
    模式识别
      发现规律
      重复利用
    抽象
      忽略细节
      抓住本质
    算法设计
      明确步骤
      可执行
```

| 能力 | 说明 | 生活示例 |
|-----|------|---------|
| **分解** | 把大问题拆成小问题 | 做蛋炒饭 → 打蛋、切葱、热油、炒饭... |
| **模式识别** | 发现规律和重复 | 每道菜都需要"备料→加热→调味" |
| **抽象** | 忽略细节，抓住本质 | "烹饪"就是"输入食材，输出菜品" |
| **算法设计** | 设计解决步骤 | 先热锅→放油→放蛋→放饭→调味 |

### 分解：把大问题拆成小问题

任何复杂的任务都可以分解成更小的子任务。

**示例：设计一个"成绩统计器"**

原始需求：
> 读取学生成绩，计算统计数据，输出报告

分解后：
```
1. 读取成绩数据（从哪里读？什么格式？）
2. 计算平均分 = 总分 / 人数
3. 找出最高分
4. 找出最低分
5. 计算及格率 = 及格人数 / 总人数 × 100%
6. 输出结果（输出到哪里？什么格式？）
```

### 模式识别：发现规律

观察问题中的重复模式，可以让解决方案更简洁。

**示例：批量处理文件**

```
处理 photo1.jpg → photo1_resized.jpg
处理 photo2.jpg → photo2_resized.jpg
处理 photo3.jpg → photo3_resized.jpg
...
```

**模式**：对于每个文件，执行相同的操作。
**抽象**：`处理(文件) → 处理后的文件`

### 抽象：忽略细节

抽象是指提取关键信息，忽略不必要的细节。

**示例：设计一个通讯录**

用户关心的：
- 存储联系人（姓名、电话、邮箱）
- 查找联系人
- 修改联系人
- 删除联系人

用户不关心的：
- 数据存在哪个文件里
- 用什么格式存储
- 查找的算法是什么

### 算法设计：设计步骤

算法是解决问题的明确步骤序列。

**示例：在列表中查找最大值**

```
1. 假设第一个元素是最大值
2. 遍历剩余元素
3. 如果当前元素 > 最大值，更新最大值
4. 返回最大值
```

---

## 问题分解：从需求到伪代码

在让 AI 写代码之前，先用自然语言描述清楚你要做什么。

```{mermaid}
flowchart TD
    A["原始需求"] --> B["明确输入输出"]
    B --> C["分解步骤"]
    C --> D["考虑边界情况"]
    D --> E["编写详细描述"]
    E --> F["让 AI 生成代码"]
    F --> G{"测试通过?"}
    G -->|否| H["补充描述"]
    H --> F
    G -->|是| I["完成"]
```

### 案例分析：成绩统计器

**第一步：明确输入输出**

- **输入**：一组成绩数据（从哪来？CSV文件）
- **输出**：统计结果（平均分、最高分、最低分、及格率）

**第二步：分解步骤**

```
1. 读取 CSV 文件中的成绩数据
2. 验证数据有效性（成绩在0-100之间）
3. 计算平均分
4. 找出最高分和最低分
5. 计算及格率（60分及格）
6. 输出统计结果
```

**第三步：考虑边界情况**

::: {.callout-warning}
## 边界情况是 AI 容易忽略的地方！
在描述问题时，主动列出边界情况，AI 才能正确处理。
:::

- 如果文件不存在怎么办？
- 如果没有数据怎么办？
- 如果有无效数据（负数、超过100、非数字）怎么办？
- 如果有人没考试（缺失值）怎么办？

**第四步：写成更详细的描述**

```
写一个 Python 函数 analyze_scores(filepath)：

输入：CSV 文件路径，文件包含 "学号,姓名,成绩" 三列

功能：
1. 读取文件，提取成绩列
2. 跳过无效数据（非数字、<0、>100）
3. 计算：平均分、最高分、最低分、及格率

输出：字典格式
{
  "average": 平均分（保留2位小数）,
  "max": 最高分,
  "min": 最低分,
  "pass_rate": 及格率百分比（保留1位小数）
}

边界处理：
- 文件不存在：抛出 FileNotFoundError
- 没有有效数据：返回 None
```

---

## Prompt Engineering 基础

Prompt Engineering 是"如何写出好的 AI 提示词"的技术。一个好的 Prompt 能让 AI 更准确地理解你的需求。

### 好 Prompt 的要素

| 要素 | 说明 | 示例 |
|-----|------|------|
| **明确目标** | 你要什么 | "写一个 Python 函数" |
| **输入输出** | 数据格式 | "输入是成绩列表，输出是字典" |
| **约束条件** | 限制和要求 | "成绩范围 0-100" |
| **示例** | 具体例子 | "例如 [80, 90, 75] → 81.67" |
| **边界情况** | 特殊情况处理 | "如果列表为空，返回 None" |

### Prompt 对比练习

**❌ 不好的 Prompt：**
```
帮我写个成绩统计的程序
```

问题：
- 没说成绩从哪来（列表？文件？）
- 没说要统计什么（平均分？排名？）
- 没说输出格式
- 没说边界情况

**✅ 好的 Prompt：**
```
写一个 Python 函数 analyze_scores(scores)：

功能：统计成绩数据

输入参数：
- scores：成绩列表，如 [85, 92, 78, 60, 45]

返回值：
- 字典，包含：
  - avg：平均分（保留2位小数）
  - max：最高分
  - min：最低分  
  - pass_rate：及格率（60分及格，百分比形式）

边界处理：
- 如果列表为空，返回 None
- 跳过非数字元素

示例：
analyze_scores([80, 90, 70]) 
→ {"avg": 80.0, "max": 90, "min": 70, "pass_rate": 100.0}
```

### Prompt 模板

复制这个模板，根据需要修改：

```
我需要一个 Python [程序/函数/类] 来 [做什么]。

输入：
- [参数1]：[类型和说明]
- [参数2]：[类型和说明]

输出：
- [返回值类型和格式]

要求：
1. [具体要求1]
2. [具体要求2]
3. [具体要求3]

边界情况：
- 如果 [情况1]，则 [处理方式]
- 如果 [情况2]，则 [处理方式]

示例：
输入：[具体示例]
输出：[期望结果]
```

---

## 实战练习：用自然语言实现计算器

### 任务描述

创建一个命令行计算器：
- 支持加减乘除
- 用户输入表达式，输出结果
- 输入 "quit" 退出

### 第一次尝试

**Prompt：**
```
写一个命令行计算器，支持加减乘除
```

**AI 可能生成的代码：**

```{python}
#| eval: false
while True:
    expr = input("请输入表达式：")
    if expr == "quit":
        break
    result = eval(expr)
    print(f"结果：{result}")
```

### 发现问题

运行测试后发现几个问题：

1. 输入非法表达式（如 "abc"）会报错
2. 使用 `eval()` 有安全风险
3. 没有友好的错误提示

### 改进 Prompt

```
写一个命令行计算器：

功能：
- 用户输入算术表达式（如 "3 + 4 * 2"）
- 程序计算并输出结果
- 输入 "quit" 退出程序

要求：
- 支持 +、-、*、/ 四种运算
- 支持小数和负数
- 不使用 eval()（安全考虑）
- 提供友好的错误提示

边界处理：
- 无效表达式：提示"表达式格式错误"
- 除以零：提示"除数不能为零"
```

### 改进后的代码

AI 会生成更完善的代码，可能使用正则表达式解析或其他方法。

```{mermaid}
flowchart LR
    subgraph 迭代循环
        A["编写 Prompt"] --> B["AI 生成代码"]
        B --> C["测试运行"]
        C --> D{"发现问题?"}
        D -->|是| E["分析问题"]
        E --> F["改进 Prompt"]
        F --> A
        D -->|否| G["✅ 完成"]
    end
```

::: {.callout-tip}
## 迭代是正常的
第一次 Prompt 不完美是正常的！发现问题后，补充描述，让 AI 改进。这就是 **Vibe Coding** 的核心流程。
:::

---

## 思考：AI 能替代计算思维吗？

**不能！**

AI 可以帮你写代码，但它不能：

1. **理解你的真实需求** —— 你需要告诉它
2. **判断方案是否合理** —— 你需要验证
3. **预见所有边界情况** —— 你需要思考
4. **为错误负责** —— 你需要审查

因此，计算思维（分解、抽象、模式识别、算法设计）在 AI 时代反而更重要——它帮助你更准确地描述问题，更有效地与 AI 协作。

---

## 课后练习

### 练习 1：问题分解

将以下任务分解为具体步骤：
> "创建一个通讯录程序，可以添加、查找、修改、删除联系人"

### 练习 2：编写 Prompt

为以下需求编写一个好的 Prompt：
> "将摄氏温度转换为华氏温度"

要求包含：输入、输出、边界情况、示例。

### 练习 3：与 AI 协作

使用你在练习2中编写的 Prompt，让 AI 生成代码。然后：
1. 测试代码是否正确
2. 发现问题并改进 Prompt
3. 在 REPORT.md 中记录迭代过程

---

## 本章小结

- **计算思维**包含分解、模式识别、抽象、算法设计四大能力
- **问题分解**是与 AI 协作的第一步：输入→处理→输出
- **边界情况**是 AI 容易忽略的，需要人工补充
- **好的 Prompt** 应包含：目标、输入输出、约束条件、示例、边界处理
- **迭代改进**是正常的：发现问题 → 改进 Prompt → 重新生成

下一章，我们将学习如何**阅读和理解** AI 生成的代码。
