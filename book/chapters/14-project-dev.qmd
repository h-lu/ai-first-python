# 综合项目开发 {#sec-project-dev}

::: {.callout-note}
## 本章概要
- **课时**：4课时（第14-15周）
- **目标**：综合运用所学，完成一个完整的项目
:::

## 学习目标

完成本章后，你将能够：

1. 进行项目需求分析和设计
2. 实践 AI 协同开发流程
3. 编写高质量的项目代码
4. 完成项目文档

---

## 项目开发流程

```{mermaid}
flowchart LR
    A["需求分析"] --> B["架构设计"]
    B --> C["模块开发"]
    C --> D["集成测试"]
    D --> E["文档完善"]
    E --> F["代码审查"]
    F --> G["项目交付"]
```

---

## 阶段一：需求分析

### 确定项目目标

```{mermaid}
mindmap
  root((项目选题))
    数据类
      数据分析仪表板
      自动报表生成
    AI 类
      智能问答助手
      内容生成工具
    工具类
      文件整理助手
      自动化脚本
    综合类
      天气播报机器人
      个人知识管理
```

### 需求文档模板

```markdown
# 项目名称：[填写]

## 项目目标
一句话描述项目解决什么问题。

## 功能需求
### 核心功能（必须完成）
1. [功能1]
2. [功能2]
3. [功能3]

### 可选功能（时间允许再做）
1. [可选功能1]
2. [可选功能2]

## 技术选型
- 语言：Python 3.10+
- 主要库：[列出使用的库]
- 接口/API：[如有]
- 界面：[命令行 / Streamlit / ...]

## 输入输出
- 输入：[描述数据来源和格式]
- 输出：[描述结果形式]

## 验收标准
- [ ] 核心功能全部可用
- [ ] 有基本的错误处理
- [ ] README 文档完整
```

---

## 阶段二：架构设计

### 模块划分原则

```{mermaid}
flowchart TD
    A["用户界面层"] --> B["业务逻辑层"]
    B --> C["数据访问层"]
    
    A1["app.py"] --> A
    B1["core.py"] --> B
    C1["data.py"] --> C
```

| 层次 | 职责 | 文件示例 |
|-----|------|---------|
| 界面层 | 用户交互、展示 | `app.py` |
| 业务层 | 核心逻辑处理 | `core.py`, `analyzer.py` |
| 数据层 | 数据读写、API 调用 | `data.py`, `api.py` |

### 项目结构示例

```
my_project/
├── app.py              # Streamlit 入口
├── core/               # 核心逻辑
│   ├── __init__.py
│   ├── analyzer.py     # 分析模块
│   └── visualizer.py   # 可视化模块
├── utils/              # 工具函数
│   ├── __init__.py
│   └── file_utils.py
├── data/               # 数据文件
│   └── sample.csv
├── tests/              # 测试
│   └── test_core.py
├── requirements.txt    # 依赖
├── README.md           # 说明文档
├── CHANGELOG.md        # 版本记录
└── .env.example        # 环境变量示例
```

---

## 阶段三：AI 协同开发

### 开发流程

```{mermaid}
flowchart TD
    A["描述需求"] --> B["AI 生成初版"]
    B --> C["运行测试"]
    C --> D{"通过?"}
    D -->|否| E["分析问题"]
    E --> F["让 AI 修正"]
    F --> C
    D -->|是| G["下一个功能"]
```

### Prompt 技巧

**功能开发 Prompt**：
```
我正在开发一个 [项目类型]，请帮我实现 [具体功能]。

要求：
- 输入：[输入描述]
- 输出：[输出描述]
- 需要处理的边界情况：[边界描述]

请生成完整的函数代码，包括：
- 类型提示
- 文档字符串
- 错误处理
```

**代码优化 Prompt**：
```
请审查以下代码并提出改进建议：

[粘贴代码]

关注点：
1. 代码清晰度
2. 错误处理
3. 性能优化
4. 可维护性
```

**调试 Prompt**：
```
这段代码运行时出现了以下错误：

错误信息：
[粘贴错误]

代码：
[粘贴代码]

请帮我分析原因并修复。
```

---

## 阶段四：代码质量

### 代码规范

```{python}
#| eval: false
def calculate_average(scores: list[float]) -> float:
    """
    计算平均分。
    
    Args:
        scores: 分数列表，每个分数应在 0-100 之间
        
    Returns:
        平均分，保留两位小数
        
    Raises:
        ValueError: 当列表为空或包含无效分数时
        
    Example:
        >>> calculate_average([80, 90, 85])
        85.0
    """
    if not scores:
        raise ValueError("分数列表不能为空")
    
    # 验证分数范围
    for score in scores:
        if not 0 <= score <= 100:
            raise ValueError(f"无效分数: {score}")
    
    return round(sum(scores) / len(scores), 2)
```

### 代码审查清单

| 检查项 | 说明 |
|-------|------|
| ✅ 功能正确 | 实现了需求描述的功能 |
| ✅ 有文档字符串 | 函数都有说明 |
| ✅ 错误处理 | 异常情况有处理 |
| ✅ 命名清晰 | 变量名有意义 |
| ✅ 没有硬编码 | API Key 等用环境变量 |
| ✅ 代码整洁 | 没有重复代码 |

---

## 阶段五：文档编写

### README.md 模板

```markdown
# 项目名称

一句话描述项目功能。

## 功能特性

- ✅ 功能1
- ✅ 功能2
- ✅ 功能3

## 快速开始

### 安装

```bash
pip install -r requirements.txt
```

### 配置

1. 复制环境变量模板：`cp .env.example .env`
2. 填写必要的 API Key

### 运行

```bash
streamlit run app.py
```

## 使用示例

[截图或 GIF 演示]

## 项目结构

```
project/
├── app.py         # 主入口
├── core.py        # 核心逻辑
└── ...
```

## 技术栈

- Python 3.10+
- Streamlit
- Pandas
- ...

## 作者

[姓名]
```

### CHANGELOG.md 模板

```markdown
# 更新记录

## v1.0.0 (YYYY-MM-DD) - 最终版本
### 新增
- 完成所有核心功能
- 添加 Web 界面

### 修复
- 修复了 xxx 问题

## v0.2.0 (YYYY-MM-DD)
### 改进
- 改进了 xxx 功能
- 添加了错误处理

## v0.1.0 (YYYY-MM-DD) - AI 初版
### 新增
- 基本功能实现
- 初始代码框架

### 已知问题
- xxx 边界情况未处理
```

---

## 课后任务

### 第14周任务

1. 完成需求文档
2. 设计项目架构
3. 开发核心功能（50%）
4. 记录 CHANGELOG

### 第15周任务

1. 完成核心功能（100%）
2. 添加 Web 界面
3. 编写 README
4. 进行代码审查
5. 准备演示

---

## 本章小结

- **需求分析**：明确目标、功能边界
- **架构设计**：分层设计、模块划分
- **AI 协同**：迭代开发、持续优化
- **代码质量**：文档、测试、规范
- **项目文档**：README、CHANGELOG

```{mermaid}
flowchart LR
    A["想法"] --> B["需求"]
    B --> C["设计"]
    C --> D["开发"]
    D --> E["测试"]
    E --> F["文档"]
    F --> G["交付"]
```

下一章，我们将进行 **项目评审与展示**。
