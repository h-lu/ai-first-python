# 期末项目反思报告

## 1. 项目定位（为什么做这个？）

### 项目名称

智能日记助手

### 解决的问题

这个项目解决什么问题？谁会用？为什么值得做？

> 我经常想记录日常生活，但写完日记后很少回顾。有时候想知道自己最近的情绪状态，或者回顾某个月发生了什么，都需要翻看大量文字。
>
> 这个项目通过 AI 自动分析情绪、生成月度总结，让"写日记"这件事变得更有价值。目标用户是像我一样想记录生活但没时间整理的人。
>
> 值得做是因为：1）日记是很私人的数据，本地存储更安全；2）AI 总结功能能真正帮助回顾成长；3）对我自己有实际用处。

### 为什么选择这个方向

你有其他选择，为什么选了这个？

> 考虑过做"智能记账"和"智能笔记搜索"。选择日记助手的原因：
> 1. 我自己有这个需求，做完可以真的用起来
> 2. 情绪分析是 LLM 的强项，不需要很复杂的 prompt 就能做得不错
> 3. 数据结构简单（日期 + 内容），不需要太复杂的数据处理

## 2. 技术决策（你是如何思考的？）

### 关键技术选型

| 决策点 | 我的选择 | 考虑过的替代方案 | 选择理由 |
|-------|---------|----------------|---------|
| 数据存储 | JSON 文件 | SQLite, CSV | JSON 简单易读，Python 原生支持好，对于个人日记量级足够 |
| 用户界面 | CLI + Streamlit | 只做 CLI | CLI 方便快速记录，Streamlit 方便浏览和分析，两者互补 |
| LLM 提供商 | DeepSeek | OpenAI, 智谱 | DeepSeek 便宜，中文效果好，API 兼容 OpenAI |
| 情绪分类 | 5 类固定标签 | 让 LLM 自由描述 | 固定标签方便统计和展示，自由描述太发散 |

### 最难的技术决策

描述一个让你纠结的技术决策，以及最终如何选择的。

> 最纠结的是**情绪分析的返回格式**。
>
> 最初让 LLM 自由描述情绪，返回类似"有点开心但也有些焦虑"。这样更准确，但很难用于统计和展示。
>
> 后来改成固定 5 个标签（开心/平静/难过/焦虑/愤怒），虽然粒度粗了，但：
> 1. 可以用 emoji 展示，视觉效果好
> 2. 可以做月度统计（本月开心 X 天）
> 3. prompt 更简单，返回更稳定
>
> 这是一个"简单胜于复杂"的决策。

## 3. 与 AI 协作

### 最有效的 Prompt

展示一个你觉得写得好的 Prompt：

```
你是一个情绪分析专家。分析用户日记的整体情绪，只返回一个情绪标签。

可选的情绪标签：开心、平静、难过、焦虑、愤怒

只返回情绪标签，不要返回其他内容。
```

为什么这个 Prompt 有效？

> 1. **角色明确**："情绪分析专家"让 AI 专注于情绪
> 2. **选项限定**：给出固定选项，避免自由发挥
> 3. **格式约束**："只返回情绪标签"确保输出可解析
> 4. **简洁**：没有多余信息，降低 token 消耗
>
> 这个 prompt 的返回准确率大概 95%，偶尔会返回"情绪：开心"这种格式，代码里做了兼容处理。

### AI 帮不了的地方

有什么是 AI 帮不了、必须你自己思考的？

> 1. **产品定位**：做什么功能、不做什么功能，这需要我根据自己需求判断
> 2. **用户体验细节**：比如 emoji 的选择、命令行参数的命名，AI 给的建议太"标准"了
> 3. **数据结构设计**：存什么字段、怎么索引，需要考虑未来扩展
> 4. **边界情况处理**：什么算"空内容"？日期格式错误怎么提示？这些需要想清楚

## 4. 迭代与成长

### 最大的挑战

描述你遇到的最大挑战，以及如何克服的。

- **挑战**：LLM 返回格式不稳定，有时候返回"开心"，有时候返回"情绪是开心的"
- **尝试的解决方案**：
  1. 改 prompt 加更多约束 → 效果一般
  2. 使用 JSON 模式 → DeepSeek 支持不完善
  3. 在代码里做后处理，提取有效情绪
- **最终方案**：组合使用——prompt 约束 + 代码兜底。prompt 里强调"只返回标签"，代码里检查返回是否在有效列表，不在就遍历提取。
- **学到的经验**：和 LLM 协作要"防御性编程"，不能假设返回一定符合预期。

### 如果重来一次

如果让你重新做这个项目，你会有什么不同的做法？

> 1. **先做 Streamlit 再做 CLI**：实际使用发现 Web 界面用得更多，应该优先打磨
> 2. **加入情绪趋势图**：月度总结现在只有文字，应该加个情绪变化曲线图
> 3. **支持图片日记**：现在只能纯文本，有点单调
> 4. **更早考虑数据迁移**：JSON 结构改了一次，旧数据手动改的，应该一开始就考虑版本兼容

## 5. 自我评价

你觉得这个项目完成度如何？有什么遗憾？

> **完成度**：我给自己打 85 分。
>
> **做得好的**：
> - 核心功能（记录、分析、总结）都实现了
> - CLI 和 Web 双界面，使用方便
> - 代码结构清晰，分了 storage/diary/llm 三层
> - 错误处理比较完善，不会轻易崩溃
>
> **遗憾**：
> - 没有做单元测试（时间不够）
> - Web 界面的美观度一般，用的默认样式
> - 情绪只有 5 类太粗糙，应该支持更细的分类
> - 没有支持日记备份/恢复功能
>
> 总体来说，这是一个我自己会真正使用的工具，这让我觉得这个项目是有意义的。

